<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>新学说-国际学校发展大会</title>
    <link href="https://cdn.bootcss.com/bootstrap/4.1.1/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="http://at.alicdn.com/t/font_551799_eo58xwv2o4siqkt9.css">
    <link rel="stylesheet" href="./css/clientWrite.css">
    <link rel="stylesheet" href="./css/commencement.css">
</head>

<body>

    <div class="container-fluid">
        <div class="content container">
            <div class="activeTitle">
                <div class="top">
                    <span class="iconfont icon-huodong1 activeTitle_logo"></span>
                    <span class="activeTitle_desc">VIS大会 报名征集</span>
                </div>
                <div class="row activityPic" id="activityPic"><img src="./image/visbanner.jpg" alt="" class="img-response"></div>
            </div>
            <form action="" id="content">
                <div class="form-group">
                    <div class="row">
                        <h4 class="col-md-12 text-center mt15" id="activityTitle">国际学校发展大会--参会报名</h4>
                        <h4 class="col-md-12 text-center mt0"><small id="activityDescription"></small></h4>
                    </div>
                </div>

                <div class="form-group">
                    <div class="row">
                        <label for="Title_input3" class="Title col-md-12 control-label" id="Title3">1.* 姓名</label>
                        <div class="col-md-12">
                            <input type="text" id="Title_input3" class="Title_input">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="row">
                        <label for="Title_input4" class="Title col-md-12 control-label" id="Title4">2.* 单位</label>
                        <div class="col-md-12">
                            <input type="text" id="Title_input4" class="Title_input">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="row">
                        <label for="Title_input5" class="Title col-md-12 control-label" id="Title5">3.* 职位</label>
                        <div class="col-md-12">
                            <input type="text" id="Title_input5" class="Title_input">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="row">
                        <label for="Title_input6" class="Title col-md-12 control-label" id="Title6">4.* 联系电话</label>
                        <div class="col-md-12">
                            <input type="text" id="Title_input6" class="Title_input">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="row">
                        <label for="Title_input7" class="Title col-md-12 control-label" id="Title7">5.* 微信号</label>
                        <div class="col-md-12">
                            <input type="text" id="Title_input7" class="Title_input">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="row">
                        <label for="Title_input8" class="Title col-md-12 control-label" id="Title8">6.* 邮箱</label>
                        <div class="col-md-12">
                            <input type="text" id="Title_input8" class="Title_input">
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="row">
                        <label class="Title col-md-12 control-label" id="Title9">7.您最期待的大会哪个主题？(多选)</label>
                        <div class="col-md-12">
                            <div class="custom-control custom-checkbox selectType mt15">
                                <input type="checkbox" id="customRadio1" name="meetingType" class="custom-control-input" value="民办教育如何破局” 高端论坛">
                                <label class="custom-control-label" for="customRadio1">“民办教育如何破局” 高端论坛</label>
                            </div>
                            <div class="custom-control custom-checkbox selectType mt15">
                                <input type="checkbox" id="customRadio2" name="meetingType" class="custom-control-input" value="全球胜任力培养">
                                <label class="custom-control-label" for="customRadio2">全球胜任力培养</label>
                            </div>
                            <div class="custom-control custom-checkbox selectType mt15">
                                <input type="checkbox" id="customRadio3" name="meetingType" class="custom-control-input" value="国际学校质量评估与保障">
                                <label class="custom-control-label" for="customRadio3">国际学校质量评估与保障</label>
                            </div>
                            <div class="custom-control custom-checkbox selectType mt15">
                                <input type="checkbox" id="customRadio4" name="meetingType" class="custom-control-input" value="母语文化教育">
                                <label class="custom-control-label" for="customRadio4">母语文化教育</label>
                            </div>
                            <div class="custom-control custom-checkbox selectType mt15">
                                <input type="checkbox" id="customRadio5" name="meetingType" class="custom-control-input" value="创新与素质教育">
                                <label class="custom-control-label" for="customRadio5">创新与素质教育</label>
                            </div>
                            <div class="custom-control custom-checkbox selectType mt15">
                                <input type="checkbox" id="customRadio6" name="meetingType" class="custom-control-input" value="人才建设与培养">
                                <label class="custom-control-label" for="customRadio6">人才建设与培养</label>
                            </div>
                            <div class="custom-control custom-checkbox selectType mt15">
                                <input type="checkbox" id="customRadio7" name="meetingType" class="custom-control-input" value="学生心理健康培养">
                                <label class="custom-control-label" for="customRadio7">学生心理健康培养</label>
                            </div>
                            <div class="custom-control custom-checkbox selectType mt15">
                                <input type="checkbox" id="customRadio8" name="meetingType" class="custom-control-input" value="投融资">
                                <label class="custom-control-label" for="customRadio8">投融资</label>
                            </div>
                            <div class="custom-control custom-checkbox selectType mt15">
                                <input type="checkbox" id="customRadio9" name="meetingType" class="custom-control-input" value="义务教育的双语课程设计">
                                <label class="custom-control-label" for="customRadio9">义务教育的双语课程设计</label>
                            </div>
                            <div class="custom-control custom-checkbox selectType mt15">
                                <input type="checkbox" id="customRadio10" name="meetingType" class="custom-control-input" value="招生与规划">
                                <label class="custom-control-label" for="customRadio10">招生与规划</label>
                            </div>
                            <div class="custom-control custom-checkbox selectType mt15">
                                <input type="checkbox" id="customRadio11" name="meetingType" class="custom-control-input" value="职能部门中基层培养">
                                <label class="custom-control-label" for="customRadio11">职能部门中基层培养</label>
                            </div>
                            <div class="custom-control custom-checkbox selectType mt15">
                                <input type="checkbox" id="customRadio12" name="meetingType" class="custom-control-input" value="双语教师的职业发展">
                                <label class="custom-control-label" for="customRadio12">双语教师的职业发展</label>
                            </div>
                            <div class="custom-control custom-checkbox selectType mt15">
                                <input type="checkbox" id="customRadio13" name="meetingType" class="custom-control-input" value="外籍学生的招生与管理">
                                <label class="custom-control-label" for="customRadio13">外籍学生的招生与管理</label>
                            </div>
                            <div class="custom-control custom-checkbox selectType mt15">
                                <input type="checkbox" id="customRadio14" name="meetingType" class="custom-control-input" value="学校与社区的联动">
                                <label class="custom-control-label" for="customRadio14">学校与社区的联动</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="row">
                        <label for="" class="Title col-md-12 control-label" id="Title10">8.您最期待演讲嘉宾分享什么内容？</label>
                        <div class="col-md-12">
                            <textarea style="min-height:150px;" id="Title_input10" class="Title_input"></textarea>
                        </div>
                    </div>
                </div>
                <div class="form-group">
                    <div class="row">
                        <label class="Title col-md-12 control-label" id="Title11">9.* 请选择购票类型</label>
                        <div class="col-md-12">
                            <div class="custom-control custom-radio selectType mt15">
                                <input type="radio" id="booking01" name="bookingType" class="custom-control-input" value="VIP票 5188元">
                                <label class="custom-control-label" for="booking01">VIP票 5188元</label>
                            </div>
                            <div class="custom-control custom-radio selectType mt15">
                                <input type="radio" id="booking02" name="bookingType" class="custom-control-input" value="会议票 3188元">
                                <label class="custom-control-label" for="booking02">会议票 3188元</label>
                            </div>
                            <div class="custom-control custom-radio selectType mt15">
                                <input type="radio" id="booking03" name="bookingType" class="custom-control-input" value="团体VIP票（3人）10800元">
                                <label class="custom-control-label" for="booking03">团体VIP票（3人）10800元</label>
                            </div>
                            <div class="custom-control custom-radio selectType mt15">
                                <input type="radio" id="booking04" name="bookingType" class="custom-control-input" value="团体会议票（10人）22300元">
                                <label class="custom-control-label" for="booking04">团体会议票（10人）22300元</label>
                            </div>
                            <div class="custom-control custom-radio selectType mt15">
                                <input type="radio" id="booking05" name="bookingType" class="custom-control-input" value="团体会议票（20人）38200元">
                                <label class="custom-control-label" for="booking05">团体会议票（20人）38200元</label>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="form-group subBox">
                    <div class="row">
                        <div class="col-md-12 text-center">
                            <input type="button" value="提交并支付" id="sub" class="btn btn-warning btn-block">
                        </div>
                    </div>
                </div>
            </form>
        </div>
    </div>
</body>

</html>
<script src="https://cdn.bootcss.com/jquery/3.2.1/jquery.min.js"></script>
<script src="https://cdn.bootcss.com/bootstrap/4.1.1/js/bootstrap.min.js"></script>
<script type="text/javascript" src="https://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
<script src="../../js/jquery.cookie.js"></script>
<script src="./js/config.js"></script>
<script>
    $(function() {
        var sub = $("#sub")

        sub.click(function() {
            var inputVal1 = $("#Title_input3").val(),
                inputVal2 = $("#Title_input4").val(),
                inputVal3 = $("#Title_input5").val(),
                inputVal4 = $("#Title_input6").val(),
                inputVal5 = $("#Title_input7").val(),
                inputVal6 = $("#Title_input8").val(),
                // inputVal7 = $("#Title_input9").val(),
                inputVal8 = $("#Title_input10").val(),
                meetingTypeVal = "",
                bookingType = ""

            $("input[name='meetingType']:checked").each(function() {
                meetingTypeVal += $(this).val() + "；"
            })

            $("input[name='bookingType']:checked").each(function() {
                bookingType = $(this).val()
            })

            if (inputVal1 && inputVal2 && inputVal3 && inputVal4 && inputVal5 && inputVal6) {

                var data = {
                    'Title1': $("#activityTitle").text(),
                    'Title2': $("#activityDescription").text(),
                    'Title3': $("#Title3").text(),
                    'Title4': $("#Title4").text(),
                    'Title5': $("#Title5").text(),
                    'Title6': $("#Title6").text(),
                    'Title7': $("#Title7").text(),
                    'Title8': $("#Title8").text(),
                    'Title9': $("#Title9").text(),
                    'Title10': $("#Title10").text(),
                    'Title11': $("#Title11").text(),
                    'Content3': inputVal1,
                    'Content4': inputVal2,
                    'Content5': inputVal3,
                    'Content6': inputVal4,
                    'Content7': inputVal5,
                    'Content8': inputVal6,
                    'Content9': meetingTypeVal,
                    'Content10': inputVal8,
                    'Content11': bookingType,
                    'Content20': "未支付"
                }

                // 判断微信环境
                function is_weixn() {
                    var ua = navigator.userAgent.toLowerCase();
                    if (ua.match(/MicroMessenger/i) == "micromessenger") {
                        return true;
                    } else {
                        return false;
                    }
                }
                // 保存姓名和邮箱
                var storage = window.localStorage;
                storage['attach'] = inputVal6

                $.ajax({
                    type: "post",
                    data: data,
                    url: 'http://' + changeUrl.address + '/Class_activity?whereFrom=insert',
                    success: function(msg) {
                        if (is_weixn()) {
                            window.location.href = "https://open.weixin.qq.com/connect/oauth2/authorize?appid=wx37e5ddff7dc5282e&redirect_uri=http%3a%2f%2fdata.xinxueshuo.cn%2fnsi-class%2fadmin%2factivity%2fmeeting%2fpages%2fvisPayPage.html&response_type=code&scope=snsapi_userinfo&state=STATE#wechat_redirect"
                        } else {
                            alert("报名成功")
                            window.location.href = "./meeting/vis2018.html"
                        }
                    }
                })
            } else {
                alert("请填写必填项")
            }

        })


    })
</script>
<script type="text/javascript" src="http://res.wx.qq.com/open/js/jweixin-1.2.0.js"></script>
<script>
    /**去掉字符串前后所有空格*/
    function trim(str) {
        return str.replace(/(^\s*)|(\s*$)/g, "");
    }

    setTimeout(function() {
        // 微信配置
        var href = window.location.href;
        // var pos = href.indexOf("from=")
        // href = href.substring(0, pos - 1)

        var title = '2018国际学校发展大会';
        var desc = '2018/11/09 北京昆泰酒店 期待您的到来';
        var imgUrl = 'https://nsi.oss-cn-zhangjiakou.aliyuncs.com/nsi-class/activity/2018vis/visbanner.jpg';

        $.ajax({
            type :   "get",
            async: true,
            traditional: true,
            data: {
                URL: href
            }, //提交的参数
            url: 'http://data.xinxueshuo.cn/nsi-0.9/Admin_api?whereFrom=WeChatShare',
            dataType :   "jsonp", //数据类型为jsonp  
            jsonp:   "Callback", //服务端用于接收callback调用的function名的参数  
            success :   function(msg) {
                // console.log(msg)
                wx.config({

                    debug: false, // 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。

                    appId: msg.appId, // 必填，公众号的唯一标识

                    timestamp: msg.timestamp, // 必填，生成签名的时间戳

                    nonceStr: msg.nonceStr, // 必填，生成签名的随机串

                    signature: msg.signature, // 必填，签名，见附录1

                    jsApiList: ['onMenuShareAppMessage', 'onMenuShareTimeline'] // 必填，需要使用的JS接口列表，所有JS接口列表见附录2

                });

                wx.ready(function() {

                    // config信息验证后会执行ready方法，所有接口调用都必须在config接口获得结果之后，config是一个客户端的异步操作，所以如果需要在页面加载时就调用相关接口，则须把相关接口放在ready函数中调用来确保正确执行。对于用户触发时才调用的接口，则可以直接调用，不需要放在ready函数中。
                    // 分享给朋友
                    wx.onMenuShareAppMessage({

                        title: title, // 分享标题

                        desc: desc, // 分享描述

                        link: href, // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致

                        imgUrl: imgUrl, // 分享图标

                        type: '', // 分享类型,music、video或link，不填默认为link

                        dataUrl: '', // 如果type是music或video，则要提供数据链接，默认为空

                        success: function() {
                            // 用户确认分享后执行的回调函数

                        },
                        cancel: function() {
                            // 用户取消分享后执行的回调函数
                        }
                    });

                    // 分享到朋友圈
                    wx.onMenuShareTimeline({

                        title: title, // 分享标题

                        link: href, // 分享链接，该链接域名或路径必须与当前页面对应的公众号JS安全域名一致

                        imgUrl: imgUrl, // 分享图标

                        success: function() {

                            // 用户确认分享后执行的回调函数

                        },

                        cancel: function() {
                            // 用户取消分享后执行的回调函数
                        }
                    });


                });
                // 处理失败验证
                wx.error(function(res) {
                    // config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。
                });

                wx.checkJsApi({

                    jsApiList: ['chooseImage'], // 需要检测的JS接口列表，所有JS接口列表见附录2,

                    success: function(res) {
                        // 以键值对的形式返回，可用的api值true，不可用为false
                        // 如：{"checkResult":{"chooseImage":true},"errMsg":"checkJsApi:ok"}
                    }
                });


            },
            error: function() {
                // alert('发生错误，请求数据失败！');
            }
        });
    }, 1000)

    // $(function() {
    //     var str = "http://class.xinxueshuo.cn/nsi-class/detailClass.html?Id=10001&from=singlemessage"
    //     var str = "http://class.xinxueshuo.cn/nsi-class/?from=singfidsojf"
    //     var pos = str.indexOf("from")
    //     var newStr = str.substring(0, pos - 1)
    //     console.log(newStr)
    // })
</script>